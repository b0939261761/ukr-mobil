{"version":3,"sources":["tracking.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"tracking.min.js","sourcesContent":["/* eslint-disable no-return-assign */\n\nconst setTrackingInputInvalid = (elem, text) => {\n  elem.setCustomValidity(text);\n  elem.classList.add('tracking__input--invalid');\n};\n\nconst clearTrackingInputInvalid = elem => {\n  elem.setCustomValidity('');\n  elem.classList.remove('tracking__input--invalid');\n};\n\nconst trackingOrderId = document.getElementById('trackingOrderId');\nconst trackingOrderIdMaskOptions = { mask: '00000 0000' };\nconst trackingOrderIdMask = IMask(trackingOrderId, trackingOrderIdMaskOptions);\n\nconst trackingOrderIdInvalidText = 'Неправильний номер квитанції. Формат xxxxx xxxx';\n\ntrackingOrderId.addEventListener('invalid', () => setTrackingInputInvalid(trackingOrderId, trackingOrderIdInvalidText));\ntrackingOrderId.addEventListener('input', () => clearTrackingInputInvalid(trackingOrderId));\n\n// ---------------------------------\n\nconst trackingPhone = document.getElementById('trackingPhone');\nconst trackingPhoneMaskOptions = { mask: '+38(\\\\000)000-00-00', lazy: false };\nconst trackingPhoneMask = IMask(trackingPhone, trackingPhoneMaskOptions);\n\nconst trackingPhoneInvalidText = 'Неправильний номер телефону. Формат 38(0xx)xxx-xx-xx';\n\ntrackingPhone.addEventListener('invalid', () => setTrackingInputInvalid(trackingPhone, trackingPhoneInvalidText));\ntrackingPhone.addEventListener('input', () => clearTrackingInputInvalid(trackingPhone));\n\n// ---------------------------------\n\nconst trackingSuccess = document.getElementById('trackingSuccess');\nconst trackingError = document.getElementById('trackingError');\n\nconst setTrackingError = text => {\n  trackingError.textContent = text;\n  trackingError.classList.add('tracking__error--open');\n};\n\nconst onSubmitTrackingForm = async evt => {\n  evt.preventDefault();\n  trackingSuccess.classList.remove('tracking__success--open');\n  trackingError.classList.remove('tracking__error--open');\n\n  const orderIdValue = trackingOrderIdMask.unmaskedValue;\n  const phoveValue = `+380${trackingPhoneMask.unmaskedValue}`;\n  const url = '/index.php?route=tracking/getStatus';\n  const body = JSON.stringify({ orderId: orderIdValue, phone: phoveValue });\n  try {\n\n\n\n\n    const response = await fetch(url, { method: 'POST', body });\n    const order = await response.json();\n    if (order.states.length) {\n      const nameList = document.querySelectorAll('.sevice-name');\n      nameList.forEach(el => el.textContent = order.name);\n\n      const price = (+order.price).toLocaleString('ru-RU');\n      const priceList = document.querySelectorAll('.sevice-price');\n      priceList.forEach(el => el.textContent = price);\n\n      const createStatusItems = (state, trackingStatus) => {\n        const trackingStatusItem = document.createElement('li');\n        trackingStatusItem.classList.add('tracking__status-item');\n        trackingStatusItem.appendChild(document.createTextNode(state.name));\n\n        const trackingStatusDate = document.createElement('span');\n        trackingStatusDate.classList.add('tracking__status-date');\n        trackingStatusDate.appendChild(document.createTextNode(state.dateFormat));\n\n        trackingStatusItem.appendChild(trackingStatusDate);\n        trackingStatus.appendChild(trackingStatusItem);\n      };\n\n      const statusListAppend = el => {\n        el.innerHTML = '';\n        order.states.forEach(state => createStatusItems(state, el));\n      };\n\n      const statusList = document.querySelectorAll('.tracking__status');\n      statusList.forEach(statusListAppend);\n      trackingSuccess.classList.add('tracking__success--open');\n    } else {\n      setTrackingError('Замовлення не знайдене');\n    }\n  } catch (err) {\n    setTrackingError(err.message);\n  }\n};\n\nconst trackingForm = document.getElementById('trackingForm');\ntrackingForm.addEventListener('submit', onSubmitTrackingForm);\n"]}