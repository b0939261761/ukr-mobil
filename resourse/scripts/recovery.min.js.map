{"version":3,"sources":["recovery.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"recovery.min.js","sourcesContent":["const pageRecoveryForm = document.getElementById('pageRecoveryForm');\n\nif (pageRecoveryForm) {\n  const pageRecoveryPassword = document.getElementById('pageRecoveryPassword');\n  const pageRecoveryConfirm = document.getElementById('pageRecoveryConfirm');\n  const pageRecoverySubmit = document.getElementById('pageRecoverySubmit');\n  const pageRecoveryResponseError = document.getElementById('pageRecoveryError');\n\n  const customInputBtnVisiblePasswordList = document.querySelectorAll('.custom-input__btn-visible-password');\n\n  const onClickCustomInputBtnVisiblePassword = ({ target }) => {\n    target.classList.toggle('custom-input__btn-visible-password--active');\n    const isActive = target.classList.contains('custom-input__btn-visible-password--active');\n    target.previousElementSibling.type = isActive ? 'text' : 'password';\n  };\n  customInputBtnVisiblePasswordList.forEach(el => el.addEventListener('click', onClickCustomInputBtnVisiblePassword));\n\n  const setCheckoutInputInvalid = (elem, text) => {\n    if (text) elem.setCustomValidity(text);\n    elem.classList.add('custom-input__input--invalid');\n  };\n\n  const clearCheckoutInputInvalid = elem => {\n    elem.setCustomValidity('');\n    elem.classList.remove('custom-input__input--invalid');\n  };\n\n  pageRecoveryPassword.addEventListener('invalid', () => {\n    setCheckoutInputInvalid(pageRecoveryPassword, 'Пароль повинен бути від 4 до 20 символів');\n  });\n\n  const onInputPageRecoveryPassword = ({ target }) => {\n    pageRecoveryConfirm.pattern = window.shared.escapeRegExp(target.value);\n    clearCheckoutInputInvalid(pageRecoveryPassword);\n  };\n  pageRecoveryPassword.addEventListener('input', onInputPageRecoveryPassword);\n\n  pageRecoveryConfirm.addEventListener('invalid', () => {\n    setCheckoutInputInvalid(pageRecoveryConfirm, 'Паролі неспівпадають');\n  });\n\n  pageRecoveryConfirm.addEventListener('input', () => clearCheckoutInputInvalid(pageRecoveryConfirm));\n\n  const onSubmitPageRecoveryForm = async evt => {\n    evt.preventDefault();\n    pageRecoverySubmit.disabled = true;\n\n    const url = '/index.php?route=recovery/recovery';\n    const body = JSON.stringify({ password: pageRecoveryPassword.value });\n\n    try {\n      const response = await fetch(url, { method: 'POST', body });\n      if (response.ok) {\n        window.location = await response.text();\n        return;\n      }\n    } catch (err) {}\n\n    pageRecoveryResponseError.classList.remove('page-recovery__response-error--hidden');\n    pageRecoverySubmit.disabled = false;\n  };\n\n  pageRecoveryForm.addEventListener('submit', onSubmitPageRecoveryForm);\n}\n"]}